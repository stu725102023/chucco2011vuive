<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Quicksand:wght@400;500&display=swap" rel="stylesheet">
    
    <title>20 - 11</title>

    <style>
        body {
            font-family: 'Quicksand', sans-serif;
            display: grid;
            place-items: center;
            min-height: 100vh;
            margin: 0;
            background: linear-gradient(135deg, #fdebed 0%, #ffc7d9 100%);
            overflow: hidden; 
        }

        /* Container cho hi·ªáu ·ª©ng r∆°i */
        #falling-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            /* QUAN TR·ªåNG: V·∫´n gi·ªØ 'none' ·ªü ƒë√¢y ƒë·ªÉ c√≥ th·ªÉ nh·∫•p xuy√™n qua
              kho·∫£ng tr·ªëng. Ch√∫ng ta s·∫Ω b·∫≠t 'auto' cho t·ª´ng v·∫≠t th·ªÉ.
            */
            pointer-events: none;
            z-index: 5;
            overflow: hidden;
        }

        /* Ki·ªÉu cho c√°c v·∫≠t th·ªÉ r∆°i (hoa, qu√†) */
        .falling-item {
            position: absolute;
            top: -10%; 
            font-size: 1.5rem; 
            user-select: none; 
            animation: fall linear forwards;

            /* --- C·∫¨P NH·∫¨T --- */
            /* Cho ph√©p nh·∫•p chu·ªôt v√†o CH·ªà v·∫≠t th·ªÉ n√†y */
            pointer-events: auto; 
            /* ƒê·ªïi con tr·ªè ƒë·ªÉ ng∆∞·ªùi d√πng bi·∫øt n√≥ c√≥ th·ªÉ nh·∫•p */
            cursor: pointer; 
            transition: transform 0.2s ease;
        }

        /* Th√™m hi·ªáu ·ª©ng hover nh·ªè */
        .falling-item:hover {
            transform: scale(1.2);
        }

        @keyframes fall {
            to {
                transform: translateY(110vh) rotate(720deg);
                opacity: 0.5; 
            }
        }

        /* --- PH·∫¶N M·ªöI: L·ªùi ch√∫c nh·ªè khi nh·∫•p --- */
        .click-message {
            position: fixed; /* Hi·ªÉn th·ªã c·ªë ƒë·ªãnh tr√™n m√†n h√¨nh */
            left: 0;
            top: 0;
            font-family: 'Quicksand', sans-serif;
            font-size: 1.25rem;
            font-weight: bold;
            color: #c2255c; /* M√†u h·ªìng ƒë·∫≠m h∆°n */
            pointer-events: none; /* Kh√¥ng th·ªÉ nh·∫•p v√†o l·ªùi ch√∫c */
            user-select: none;
            z-index: 1001; /* Lu√¥n ·ªü tr√™n c√πng */
            
            /* G·ªçi animation 'floatUp' */
            animation: floatUp 1.5s ease-out forwards;
        }

        /* --- PH·∫¶N M·ªöI: Animation cho l·ªùi ch√∫c nh·ªè --- */
        @keyframes floatUp {
            from {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            to {
                opacity: 0;
                transform: translateY(-50px) scale(0.8);
            }
        }
        /* --- H·∫øt ph·∫ßn m·ªõi --- */


        /* Th∆∞ v√† th·∫ª */
        #envelope, #card {
            position: relative; 
            z-index: 10;
        }

        #envelope {
            cursor: pointer;
            background: white; /* M√†u th√¢n th∆∞ */
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            position: relative; 
            z-index: 10; 

            /* 1. ƒê·∫∑t k√≠ch th∆∞·ªõc c·ªë ƒë·ªãnh */
            width: 300px; /* Chi·ªÅu r·ªông l√° th∆∞ */
            height: 180px; /* Chi·ªÅu cao l√° th∆∞ */

            /* 2. D√πng flex ƒë·ªÉ cƒÉn gi·ªØa ch·ªØ */
            display: flex;
            justify-content: center;
            align-items: center;

            /* 3. Bo g√≥c nh·∫π cho gi·ªëng th∆∞ */
            border-radius: 8px;
        }

        #envelope:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
        }

        #envelope::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            
            /* T·∫°o tam gi√°c b·∫±ng border:
              - border-top: l√† 'm√†u' v√† 'chi·ªÅu cao' c·ªßa tam gi√°c
              - border-left/right: l√† 'c·∫°nh' trong su·ªët, 
                ƒë·ªô r·ªông b·∫±ng 1/2 chi·ªÅu r·ªông th∆∞ (300/2 = 150)
            */
            border-top: 90px solid #f5f5f5; /* Cao 90px (n·ª≠a l√° th∆∞), m√†u x√°m nh·∫°t */
            border-left: 150px solid transparent;
            border-right: 150px solid transparent;

            z-index: 1; /* N·∫±m d∆∞·ªõi ch·ªØ */
            
            /* Bo tr√≤n 2 g√≥c tr√™n c·ªßa n·∫Øp */
            border-top-left-radius: 8px;
            border-top-right-radius: 8px;
        }
        /* Th√™m 'ƒë∆∞·ªùng k·∫ª' m√©p n·∫Øp */
        #envelope::after {
            content: '';
            position: absolute;
            left: 0;
            top: 90px; /* ƒê√∫ng v·ªã tr√≠ 1/2 chi·ªÅu cao */
            width: 100%;
            height: 1px;
            background: #e0e0e0; /* M√†u ƒë∆∞·ªùng k·∫ª m·ªù */
            z-index: 2; /* N·∫±m tr√™n n·∫Øp */
        }
        #envelope p {
            margin: 0;
            font-size: 1.5rem;
            font-weight: 500;
            color: #d6336c;
            
            /* Quan tr·ªçng: ƒê·∫∑t ch·ªØ l√™n tr√™n n·∫Øp th∆∞ */
            position: relative;
            z-index: 3;
        }
        
        #card {
            display: none; 
            text-align: center;
            background: white;
            padding: 2.5rem;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            animation: fadeIn 0.5s ease-in-out;
            max-width: 90%;
            box-sizing: border-box; 
        }

        #main-title {
            font-family: 'Dancing Script', cursive;
            font-size: 3rem;
            color: #d6336c;
            margin-top: 0;
            margin-bottom: 0.5rem;
        }

        #card .message {
            font-size: 1.25rem;
            color: #333;
            margin-bottom: 1.5rem;
        }

        #card img {
            max-width: 100%;
            height: auto;
            max-height: 200px;
            border-radius: 10px;
            margin-bottom: 1.5rem;
        }
        
        #card .footer-text {
            font-size: 1rem;
            color: #888;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
    </style>
</head>
<body>
    <audio id="background-music" loop>
        <source src="super mario soundtrack.mp3" type="audio/mpeg">
    </audio>
    <div id="falling-container"></div>

    <div id="envelope">
        <p>üíå</p>
    </div>

    <div id="card">
        <h1 id="main-title"></h1>
        <p class="message">Ch√∫c c√¥ lu√¥n th√†nh c√¥ng trong s·ª± nghi·ªáp, c√≥ nhi·ªÅu ni·ªÅm vui v√† h·∫°nh ph√∫c trong cu·ªôc s·ªëng!</p>
        <img src="https://media.tenor.com/E8j-nQk3D-cAAAAi/peach-goma.gif" alt="Cute animation">
        <!-- <p class="footer-text">L·ªùi ch√∫c ·ªü ƒë√¢y</p> -->
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            
            // --- Ph·∫ßn 1: X·ª≠ l√Ω logic c·ªßa th·∫ª ch√∫c (gi·ªØ nguy√™n) ---
            const envelope = document.getElementById('envelope');
            const card = document.getElementById('card');
            const titleElement = document.getElementById('main-title');

            try {
                const urlParams = new URLSearchParams(window.location.search);
                const idData = urlParams.get('id');

                if (idData) {
                    const decodedString = atob(idData);
                    const data = JSON.parse(decodedString);
                    titleElement.textContent = data.title || "Ch√∫c m·ª´ng b·∫°n!";
                } else {
                    titleElement.textContent = "Vietnamese Teacher's Day 20-11";
                }
            } catch (e) {
                console.error("L·ªói khi x·ª≠ l√Ω d·ªØ li·ªáu URL:", e);
                titleElement.textContent = "G·ª≠i b·∫°n l·ªùi ch√∫c!";
            }

            envelope.addEventListener('click', function() {
                envelope.style.display = 'none';
                card.style.display = 'block';
            });
            envelope.addEventListener('click', function() {
                envelope.style.display = 'none';
                card.style.display = 'block';

                /* --- PH·∫¶N TH√äM M·ªöI ƒê·ªÇ CH·∫†Y NH·∫†C --- */
                const audio = document.getElementById('background-music');
                audio.play();
                /* --- H·∫øt ph·∫ßn th√™m m·ªõi --- */
            });

            // --- Ph·∫ßn 2: T·∫°o hi·ªáu ·ª©ng r∆°i ---

            const container = document.getElementById('falling-container');
            const items = ['üå∏', 'üå∫', 'üíñ', 'üéâ', 'üéÅ', 'üíù'];

            /* --- PH·∫¶N M·ªöI: M·∫£ng c√°c l·ªùi ch√∫c nh·ªè --- */
            const shortMessages = [
                "H·∫°nh ph√∫c nh√©!", 
                "Lu√¥n xinh!", 
                "Y√™u ƒë·ªùi!", 
                "R·∫°ng r·ª°!", 
                "Tuy·ªát v·ªùi!",
                "D·ªÖ th∆∞∆°ng!"
            ];

            function createFallingItem() {
                const item = document.createElement('span');
                item.classList.add('falling-item');
                item.textContent = items[Math.floor(Math.random() * items.length)];
                
                item.style.left = Math.random() * 100 + 'vw';
                item.style.animationDuration = (Math.random() * 5 + 5) + 's';
                item.style.fontSize = (Math.random() * 1 + 1) + 'rem';
                item.style.opacity = Math.random() * 0.5 + 0.5;

                /* --- PH·∫¶N M·ªöI: Th√™m s·ª± ki·ªán click cho v·∫≠t th·ªÉ r∆°i --- */
                item.addEventListener('click', function(event) {
                    // 1. ·∫®n v·∫≠t th·ªÉ ƒëi cho ƒë·ª° v∆∞·ªõng
                    this.style.display = 'none';

                    // 2. T·∫°o l·ªùi ch√∫c nh·ªè
                    const messageEl = document.createElement('span');
                    messageEl.classList.add('click-message');
                    
                    // 3. Ch·ªçn ng·∫´u nhi√™n m·ªôt l·ªùi ch√∫c
                    const randomMsg = shortMessages[Math.floor(Math.random() * shortMessages.length)];
                    messageEl.textContent = randomMsg;

                    // 4. ƒê·∫∑t v·ªã tr√≠ c·ªßa l·ªùi ch√∫c t·∫°i n∆°i nh·∫•p chu·ªôt
                    // event.clientX/Y l√† v·ªã tr√≠ con tr·ªè tr√™n m√†n h√¨nh
                    messageEl.style.left = event.clientX + 'px';
                    messageEl.style.top = event.clientY + 'px';

                    // 5. Th√™m v√†o trang (ph·∫£i th√™m v√†o body m·ªõi ho·∫°t ƒë·ªông 
                    //    v√¨ container c√≥ pointer-events: none)
                    document.body.appendChild(messageEl);

                    // 6. X√≥a l·ªùi ch√∫c sau khi animation ho√†n t·∫•t (1.5 gi√¢y)
                    setTimeout(() => {
                        messageEl.remove();
                    }, 1500);
                });
                /* --- H·∫øt ph·∫ßn m·ªõi --- */


                container.appendChild(item);

                setTimeout(() => {
                    item.remove();
                }, 10000);
            }

            setInterval(createFallingItem, 300);
        });
    </script>

</body>
</html>